DROP DATABASE f;
CREATE DATABASE f;

USE f;

CREATE TABLE TIPO_VEICULO (
   COD_TIPO_VEICULO 	INT NOT NULL AUTO_INCREMENT,
   DSC_TIPO_VEICULO 	VARCHAR (45) NOT NULL,
   CONSTRAINT PK_TIPO_VEICULO 
   PRIMARY KEY (COD_TIPO_VEICULO)
) ENGINE = INNODB;

CREATE TABLE MARCA (
   COD_MARCA 		INT NOT NULL AUTO_INCREMENT,
   NOM_MARCA 		VARCHAR (45) NOT NULL,
   NOM_MARCA_FIPE 	VARCHAR (45) NOT NULL,
   KEY_MARCA   		VARCHAR (45) NOT NULL,
   ID_MARCA_FIPE 		VARCHAR (45) NOT NULL,
   CONSTRAINT PK_MARCA PRIMARY KEY (COD_MARCA)
   CONSTRAINT FK_MARCA FOREIGN KEY (COD_MARCA) REFERENCES COMERCIALIZA (COD_MARCA));
) ENGINE = INNODB;

ALTER TABLE MARCA CHANGE NOM_MARCA NOM_MARCA VARCHAR(100);
ALTER TABLE MARCA ADD COD_GRUPO INT;

CREATE TABLE VEICULO (
   COD_VEICULO 		INT NOT NULL AUTO_INCREMENT,
   NOM_VEICULO 		VARCHAR (45) NOT NULL,
   NOM_VEICULO_FIPE 		VARCHAR (45),
   KEY_VEICULO 		VARCHAR (45),
   ID_VEICULO 			VARCHAR (45),
   COD_MARCA 		INT	NOT NULL,
   COD_TIPO_VEICULO 		INT 	NOT NULL,
   CONSTRAINT PK_TABELA PRIMARY KEY (COD_VEICULO),
   CONSTRAINT FK_TABELA_MARCA 
   FOREIGN KEY (COD_MARCA)
   REFERENCES MARCA (COD_MARCA),
   CONSTRAINT FK_TABELA_TIPO_VEICULO 
   FOREIGN KEY (COD_TIPO_VEICULO)
   REFERENCES TIPO_VEICULO (COD_TIPO_VEICULO)        
) ENGINE = INNODB;

ALTER TABLE VEICULO CHANGE NOM_VEICULO NOM_VEICULO VARCHAR(100);


CREATE TABLE MODELO (
   SEQ_MODELO 		INT NOT NULL AUTO_INCREMENT,
   DESC_MODELO 		VARCHAR (100) NOT NULL,
   KEY_MODELO_FIPE	VARCHAR (20) NOT NULL,
   COD_MODELO_FIPE 	VARCHAR (20) NOT NULL,
   ID_MODELO_FIPE 	VARCHAR (20) NOT NULL,
   COD_VEICULO 		INT NOT NULL,
   CONSTRAINT PK_MODELO PRIMARY KEY (SEQ_MODELO),
   CONSTRAINT FK_MODELO_VEICULO 
   FOREIGN KEY (COD_VEICULO)
   REFERENCES VEICULO (COD_VEICULO)
) ENGINE = INNODB;

CREATE TABLE VALOR_VEICULO (
   SEQ_VALOR_VEICULO 		INT NOT NULL AUTO_INCREMENT,
   MES_REF_VALOR_VEICULO 		INT NOT NULL,
   ANO_REF_VALOR_VEICULO 		YEAR NOT NULL,
   DESC_VEICULO 			VARCHAR (100) NOT NULL,
   PCO_VALOR_VEICULO 		DECIMAL (10,2) NOT NULL,
   KEY_VEICULO 			VARCHAR (20) NOT NULL,
   ID_VEICULO_FIPE 			VARCHAR (20) NOT NULL,
   COD_VEICULO_FIPE 			VARCHAR (20),
   SEQ_MODELO_VEICULO 		INT NOT NULL,
   CONSTRAINT PK_VALOR_VEICULO 
   PRIMARY KEY (SEQ_VALOR_VEICULO), 
   CONSTRAINT FK_VALOR_VEICULO_MODELO 
   FOREIGN KEY (SEQ_MODELO_VEICULO)
   REFERENCES MODELO (SEQ_MODELO)
) ENGINE = INNODB;

CREATE TABLE IF NOT EXISTS CLIENTE (
COD_PESSOA INT NOT NULL AUTO_INCREMENT,NOM_PESSOA VARCHAR(250) NOT NULL,
CPF_PESSOA VARCHAR(16),
RG_PESSOA VARCHAR(12),
EMAIL_PESSOA VARCHAR(100),
DTA_NASC_PESSOA DATE NOT NULL,
IDF_SEXO VARCHAR(1),
IDF_ATIVO VARCHAR(1) DEFAULT 'S',
COD_TIPO_PESSOA INT NOT NULL,
CONSTRAINT PK_PESSOA PRIMARY KEY (COD_PESSOA),
CONSTRAINT UQ_PESSOA_CPF UNIQUE (CPF_PESSOA),
CONSTRAINT UQ_PESSOA_RG UNIQUE (RG_PESSOA),
CONSTRAINT UQ_PESSOA_EMAIL UNIQUE (EMAIL_PESSOA));

CREATE TABLE IF NOT EXISTS COMERCIALIZA (
SEQ_COMERCIALIZA INT,
COD_TIPO_VEICULO INT,
COD_MARCA INT,
CONSTRAINT FK_COMERCIALIZA FOREIGN KEY (SEQ_COMERCIALIZA) REFERENCES COMERCIALIZA (SEQ_COMERCIALIZA));

CREATE TABLE IF NOT EXISTS GRUPO (
COD_GRUPO INT,
NOM_GRUPO VARCHAR(100),
IDF_ATIVO VARCHAR(1),
CONSTRAINT FK_MARCA FOREIGN KEY (COD_MARCA) REFERENCES MARCA (COD_MARCA));

CREATE TABLE IF NOT EXISTS VEICULOS_EMPRESA (
PLACA VARCHAR(7),
SITUACAO VARCHAR(1),
SEQ_MODELO VARCHAR(1),
COR_VEICULO VARCHAR(20),
ANO_VEICULO YEAR,
CONSTRAINT FK_VEICULOS_EMPRESA FOREIGN KEY (PLACA) REFERENCES VEICULOS_EMPRESA (PLACA));




